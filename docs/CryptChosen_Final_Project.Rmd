---
title: "The rising price of Bitcoin, compared to the global inflation of fiat currency"
author: "CRYPTCHOSEN: Ethan Swaidner, Josh Braseth, and Steven Bogus"
date: "Friday, May 3, 2024"
output:
  html_document:
    highlight: tango
    theme: cosmo
    toc: true
    toc_float: true
    toc_depth: 2
    collapsed: false
    smooth_scroll: false
    df_print: kable
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

<!-- DO NOT EDIT ANYTHING ABOVE THIS LINE -->

```{r setup, include=FALSE}
# tidyverse does not work on my machine, so we need to install the packages separately
library(ggplot2)
library(dplyr)
library(tidyr)
library(readr)
library(infer)
library(lubridate)
library(janitor)
library(knitr)
library(moderndive)
```

<img src="../assets/images/wazir_article_img_eight.jpg" alt="Crypto Graph" onerror="this.onerror=null; this.src='https://stat2.moneycontrol.com/assets/images/ms/wazirx/wazir_article_img_eight.jpg'">


#### Last updated on 2024-05-03

<br>

# 1. Introduction

Cryptocurrency, and in particular Bitcoin, has come a long way from its mediocre rise in the early 2010's. What was once considered a waste of money, and not highly regarded, has dramatically increased in price and now is staple of the online space and modern world. As bitcoin continues its rise, it's important to consider that the global economy as a whole is declining, as inflation rates continue to climb. Our project investigates whether there's a correlation between global economic inflation and the value of Bitcoin - and if there is one, what exactly is the correlation that can be drawn?

To answer this question, we will be using our data set derived from the CryptoCompare API<a href="https://min-api.cryptocompare.com/documentation?key=Historical&cat=dataHistoday">³</a>, which shows the price of Bitcoin and its price movements over the past ten years. CryptoCompare is an FCA benchmark administrator<a href="https://finance.yahoo.com/news/cryptocompare-gets-fca-authorization-operate-125346571.html">²</a> and is used by some of the largest companies such as Coinbase, and Binance. We will be using their dataset and analyzing Bitcoin daily closing price and trading volume variables in relation to global inflation metrics derived from per-country month-over-month changes in the Consumer Price Index (CPI). The inflation data we will be comparing it to is provided by The World Bank from their database<a href="https://www.worldbank.org/en/research/brief/inflation-database ">¹</a>. The World Bank is an exceptionally reliable source, getting the data for its datasets directly from the government agencies of each country it references. The data for this dataset was updated April 2024. 

We decided to focus on the inflation of G7 countries as they have the most stable and advanced economies, account for more than a third of the global GDP<a href="https://www.bbc.com/news/world-49434667">⁴</a>, and are great points of reference of the global economy as a whole. Another thing that is important to note is that unlike most projects, we will be comparing 2 numeric values instead.

Here is a snapshot of 5 randomly chosen rows of the data set we’ll use from the CryptoCompare dataset:
```{r}
btc <- read_csv("../btcdailyprice.csv") %>%
  clean_names() %>%
  select(year:day, open:close)
set.seed(123) 
btc_sample <- btc %>% sample_n(5)
print(btc_sample)
```

Here is a snapshot of 5 randomly chosen rows of the filtered data set (only G7 countries) we’ll use from the World Bank dataset:
```{r}
globalinflation <- read_csv("../globalinflation.csv") %>%
  clean_names()
globalinflation <- globalinflation %>%
  mutate(g7 = rowMeans(select(globalinflation, united_states, united_kingdom, canada, france, germany, italy, japan), na.rm = TRUE))
set.seed(123)
globalinflation_sample <- globalinflation %>% sample_n(5)
globalinflation_sample <- globalinflation_sample %>% 
  select(united_states, united_kingdom, canada, france, germany, italy, japan, g7)
print(globalinflation_sample)
```

# 2. Exploratory data analysis

The CryptoCompare dataset had a sample size of 5586 for the daily price of BTC from 2009 to the present. The World Bank database, filtering out everything but the G7 countries, had a sample size of 1092, 156 for each country, or one data point a month from 2010 to 2023. We were luckily able to use every single data point and did not have to remove any from either sample.

```{r}
{include=FALSE}
# loading btc data set
btc <- read_csv("../btcdailyprice.csv") %>%
  clean_names() %>%
  select(year:day, open:close)

# remove days before btc was first traded
btc <- slice(btc, (561):nrow(btc))

# make single column date
btc$date <- dmy(paste(btc$day, btc$month, btc$year, sep = "-"))

# loading inflation data set
globalinflation <- read_csv("../globalinflation.csv") %>%
  clean_names()

# compute G7 monthly inflation average
globalinflation <- globalinflation %>%
  mutate(g7 = rowMeans(select(globalinflation, united_states, united_kingdom, canada, france, germany, italy, japan), na.rm = TRUE))

# make single column date
globalinflation$date <- my(paste(globalinflation$month, globalinflation$year, sep = "-"))


```

<br>

```{r, fig.width=8, fig.height=4.5, warning=FALSE}
ggplot(btc, aes(x = date, y = close)) +
  geom_line() +
  labs(title = "Bitcoin Price", x = "Date", y = "Closing Price [USD]") +
  theme_minimal()
```

<p style="text-align: center;">Figure 1 - Bitcoin Price</p> 

<br>

Figure 1 is a line graph of the closing price of Bitcoin over time. It highlights periods of significant growth or decline, visualizing the trends. Analyzing them can help us understand factors the influence Bitcoin's market value at certain times.

<br>


```{r, fig.width=8, fig.height=4.5, warning=FALSE}
ggplot(globalinflation, aes(x=date, y=g7)) +
  geom_line() +
  labs(title="Global Average CPI Inflation over Time", x="Time", y="Global Average CPI Inflation")
```

<p style="text-align: center;">Figure 2 - Global Average CPI Inflation (2018-2022)</p> 

<br>

Figure 2 is a line graph that illustrates the global average Consumer Price Index (CPI) inflation over time. By comparing this with Bitcoin's price trends, we can investigate potential correlations between global economic inflation and Bitcoin's value.

<br>


```{r, fig.width=8, fig.height=4.5, warning=FALSE}
ggplot(btc, aes(x=month, y=close)) +
  geom_boxplot() +
  labs(title="Monthly Variation in Bitcoin Closing Price", x="Month", y="Closing Price [USD]") +
  theme(axis.text.x=element_text(angle=45, hjust=1)) +
  theme_minimal()
  btc$cumulative_volume <- cumsum(btc$volumefrom)
```

<p style="text-align: center;">Figure 3 - Monthly Variation in Bitcoin Closing Price</p> 

<br>

Figure 3 breaks down Bitcoin's closing price by month, showing the distribution within each month. It highlights the intra-month variability and may help identify seasonal patterns or anomalies in Bitcoin's price movements.

<br>


```{r, fig.width=8, fig.height=4.5, warning=TRUE}
ggplot(btc, aes(x=date, y=cumulative_volume)) +
  geom_area(fill="green", alpha=0.5) +
  labs(title="Cumulative Volume of Bitcoin Traded Over Time", x="Date", y="Cumulative Volume Traded") +
  theme_minimal()
```

<p style="text-align: center;">Figure 4 - Cumulative Volume of Bitcoin Traded Over Time</p> 

<br>

Figure 4 is an area graph that depicts the cumulative trading volume of Bitcoin over time. It demonstrates the overall growth in Bitcoin trading activity, which can be an indicator of increasing or decreasing interest in the cryptocurrency. Not much to see here, to be honest!

<br>


```{r, fig.width=8, fig.height=4.5, warning=TRUE}
ggplot(btc, aes(x=volumefrom, y=close)) +
  geom_point(aes(color=close), alpha=0.6) +
  scale_color_gradient(low="blue", high="red") +
  labs(title="Trading Volume vs. Closing Price of Bitcoin", x="Volume Traded", y="Closing Price [USD]") +
  theme_minimal()
```

<p style="text-align: center;">Figure 5- Trading Volume vs. Closing Price of Bitcoin</p> 

<br>

Figure 5 is a scatter plot that explores the relationship between the trading volume and the closing price of Bitcoin. By examining how these two variables interact, we can gain insights into market dynamics, such as whether high trading volumes are associated with significant price changes. It would be very interesting to tie the color to another categorical variable, or even the size of the dots to another in order to visualize and communicate a lot of information.

<br>


```{r warning=FALSE}
btc$close_normalized <- btc$close / max(btc$close, na.rm = TRUE)

globalinflation$g7_normalized <- globalinflation$g7 / max(globalinflation$g7, na.rm = TRUE)

start_date <- max(min(btc$date), min(globalinflation$date))
end_date <- min(max(btc$date), max(globalinflation$date))

btc <- btc %>% filter(date >= start_date & date <= end_date)
globalinflation <- globalinflation %>% filter(date >= start_date & date <= end_date)

combined_data <- bind_rows(
  btc %>% select(date, close) %>% rename(value = close) %>% mutate(variable = "Bitcoin Price"),
  globalinflation %>% select(date, g7) %>% rename(value = g7) %>% mutate(variable = "Global Average CPI Inflation")
)

ggplot(combined_data, aes(x = date, y = value)) +
  geom_line() +
  facet_grid(rows = vars(variable), scales = "free_y") +
  labs(title = "Bitcoin Price and Global Average CPI Inflation", x = "Date", y = "Value") +
  theme_minimal()

```

<p style="text-align: center;">Figure 6 - Bitcoin Price and Global Average CPI Inflation</p> 

And lastly, Figure 6 is 2 line graphs on the same plane that directly show Bitcoin's Price and the Global Average CPI Inflation side by side. We thought it would be interesting to directly compare Bitcoin's Price and Average Inflation. Having these two values side by side can let us draw some basic correlations, and see if there seems to be any relationships between the two. If there are jumps in both in around the same time frame it could mean there is a relationship. Especially in the most recent years, we can see a major jump at around the same time. 

# 3 Multiple regression
```{r}
# interpolate g7 average monthly inflation to daily in order to match frequency with btc data
interpolated_g7 <- approx(globalinflation$date, globalinflation$g7, xout = btc$date)$y

btc_model_cols <- data.frame(close = btc$close, inflation = interpolated_g7, date = btc$date)

# multiple regression model
btc_model <- lm(close ~ inflation + date, data = btc_model_cols)
get_regression_table(btc_model)
```


## 3.1 - Statistical interpretation

## 3.2 - Non-statistical interpretation


# 4. Inference for multiple regression
```{r}
reg_points <- get_regression_points(btc_model)
```

To answer our research question, we need to test the null hypothesis "there is no relationship between
G7 average CPI inflation the closing price of bitcoin".

//TODO hypothesis equations



## 4.1 - Residual analysis
```{r}
ggplot(data = reg_points, aes(x = residual)) +
  geom_histogram(binwidth = 3000, fill = "deepskyblue4", color = "white") +
  labs(title = "Histogram of Residuals",
       x = "Residuals",
       y = "Frequency")
```

```{r}
ggplot(data = reg_points, aes(x = close_hat, y = residual)) +
  geom_point(color = "deepskyblue4") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Residual vs. Fitted Values",
       x = "Fitted",
       y = "Residual")
```

```{r}
ggplot(data = reg_points, aes(x = inflation, y = residual)) +
  geom_point(color = "deepskyblue4") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Residual vs. Inflation",
       x = "Inflation",
       y = "Residual")
```

```{r}
ggplot(data = reg_points, aes(x = date, y = residual)) +
  geom_point(color = "deepskyblue4") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Residual vs. Date",
       x = "Date",
       y = "Residual")
```

# 5. Conclusion

## 5.1 - Conclusions

Conclusion. Was there a correlation?

## 5.2 - Limitations

Limitations we had

## 5.3 - Further questions

Questions the data provokes


# 6. Citations and References
A Global Database of Inflation. (n.d.). World Bank. https://www.worldbank.org/en/research/brief/inflation-database

<br>

CryptoCompare Gets FCA Authorization to Operate as Benchmark Administrator. (2021, November 4). Yahoo Finance. https://finance.yahoo.com/news/cryptocompare-gets-fca-authorization-operate-125346571.htmlCryptocurrency API, Historical & Real-Time Market Data. (n.d.). 

<br>

CryptoCompare. Retrieved April 29, 2024, from https://min-api.cryptocompare.com/documentation?key=Historical&cat=dataHistoday

<br>

What is the G7 summit and what does it do? (2019, August 23). BBC News. https://www.bbc.com/news/world-49434667
